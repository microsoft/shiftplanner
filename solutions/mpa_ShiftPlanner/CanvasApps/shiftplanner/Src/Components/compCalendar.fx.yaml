compCalendar As CanvasComponent:
    CalendarHeight: =768
    CalendarWidth: =1366
    ConfirmationScreen: =App.ActiveScreen
    Fill: =RGBA(0, 0, 0, 0)
    Height: =compCalendar.CalendarHeight
    OnReset: =
    TodayDate: =Text(Today(), DateTimeFormat.LongDate)
    Width: =compCalendar.CalendarWidth
    X: =0
    Y: =0
    ZIndex: =1

    conCalendar_CalendarComp As groupContainer.verticalAutoLayoutContainer:
        Height: =Parent.Height
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        PaddingBottom: =20
        PaddingLeft: =20
        PaddingRight: =20
        PaddingTop: =20
        Width: =Parent.Width
        ZIndex: =1

        conMonthHeader_CalendarComp As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =50
            LayoutGap: =10
            LayoutMaxHeight: =
            LayoutMaxWidth: =
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            LayoutWrap: =true
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
            ZIndex: =1

            lblTodayHeader_CalendarComp As Text:
                Align: ='TextCanvas.Align'.Start
                AutoHeight: =false
                BorderColor: =
                BorderStyle: =""
                DisplayMode: =DisplayMode.Edit
                Fill: =
                FillPortions: =0.3
                FontColor: =ColorValue(varTheme.neutralForeground3)
                Height: =conCalendarHeader_CalendarComp.Height
                LayoutMaxHeight: =
                LayoutMaxWidth: =
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                Size: =
                Text: =Concatenate("Today is " & compCalendar.TodayDate)
                VerticalAlign: =VerticalAlign.Top
                Weight: =varThemeFont.H3.weight
                Width: =400
                X: =0
                Y: =0
                ZIndex: =1

            conCalendarHeader_CalendarComp As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.Start
                FillPortions: =0.9
                Height: =Parent.Height - Parent.PaddingBottom - Parent.PaddingTop
                LayoutMaxHeight: =
                LayoutMaxWidth: =
                LayoutMinHeight: =100
                LayoutMinWidth: =100
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                ZIndex: =5

                icoPrevMonth_CalendarComp As icon.ChevronLeft:
                    AccessibleLabel: ="Previous Month Left Arrow Icon"
                    BorderColor: =RGBA(166, 166, 166, 1)
                    Color: =//App.Theme.Colors.Primary
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =Self.Color
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    FocusedBorderColor: =ColorValue(varTheme.statusInformative)
                    FocusedBorderThickness: =4
                    Height: =30
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverColor: =Self.Color
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Icon: =Icon.ChevronLeft
                    LayoutMaxHeight: =
                    LayoutMaxWidth: =
                    OnSelect: |
                        =/*changes month view to previous month*/
                        Set(varFirstDayOfMonth, DateAdd(varFirstDayOfMonth, -1, TimeUnit.Months));
                        Set(varFirstDayInView, DateAdd(varFirstDayOfMonth, -(Weekday(varFirstDayOfMonth) - 2 + 1), TimeUnit.Days));
                        Set(varLastDayOfMonth, DateAdd(DateAdd(varFirstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
                        /*collects calendar events for all days in current month view. Updates varMinDate to prevent duplicate data collection if user returns to this month view*/
                        If(varMinDate > varFirstDayOfMonth, Set(varMinDate, varFirstDayOfMonth));
                        //Resets the date selected to today if it's this month, and blank if it isn't this month
                        Set(
                            varDateSelected,
                            If(Text(varFirstDayOfMonth, "mmmm yyyy") = Text(Today(), "mmmm yyyy"), Today(), 
                                If(IsBlank(varDateSelected), Today(), varDateSelected)
                            )
                        );
                    PaddingBottom: =7
                    PaddingLeft: =7
                    PaddingRight: =7
                    PaddingTop: =7
                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                    PressedColor: =Self.Color
                    PressedFill: =RGBA(0, 0, 0, 0)
                    TabIndex: =0
                    Tooltip: ="View previous month"
                    Width: =59
                    X: =20
                    Y: =80
                    ZIndex: =1

                lblMonthHeader_CalendarComp As Text:
                    Align: ='TextCanvas.Align'.Center
                    BorderColor: =
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Fill: =
                    FontColor: =
                    Height: =28
                    LayoutMaxHeight: =
                    LayoutMaxWidth: =
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    Size: =varThemeFont.H3.size
                    Text: =Text(varFirstDayOfMonth , "mmmm yyyy")
                    Weight: =varThemeFont.H3.weightBold
                    Width: =200
                    X: =0
                    Y: =0
                    ZIndex: =2

                icoNextMonth_CalendarComp As icon.ChevronRight:
                    AccessibleLabel: ="Next Month Right Arrow Icon"
                    BorderColor: =RGBA(166, 166, 166, 1)
                    Color: =//App.Theme.Colors.Primary
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =Self.Color
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    FocusedBorderColor: =ColorValue(varTheme.statusInformative)
                    FocusedBorderThickness: =4
                    Height: =30
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverColor: =Self.Color
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Icon: =Icon.ChevronRight
                    LayoutMaxHeight: =
                    LayoutMaxWidth: =
                    OnSelect: |
                        =/*changes month view to next month*/
                        Set(varFirstDayOfMonth, DateAdd(varFirstDayOfMonth, 1, TimeUnit.Months));
                        Set(varFirstDayInView, DateAdd(varFirstDayOfMonth, -(Weekday(varFirstDayOfMonth) - 2 + 1), TimeUnit.Days));
                        /*collects calendar events for all days in current month view. Updates varMaxDate to prevent duplicate data collection if user returns to this month view*/
                        Set(varLastDayOfMonth, DateAdd(DateAdd(varFirstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
                        If(varLastDayOfMonth > varMaxDate, Set(varMaxDate, varLastDayOfMonth));
                        //Resets the date selected to today if it's this month, and blank if it isn't this month
                        Set(
                            varDateSelected,
                            If(Text(varFirstDayOfMonth, "mmmm yyyy") = Text(Today(), "mmmm yyyy"), Today(), 
                                If(IsBlank(varDateSelected), Today(), varDateSelected)
                            )
                        );
                    PaddingBottom: =7
                    PaddingLeft: =7
                    PaddingRight: =7
                    PaddingTop: =7
                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                    PressedColor: =Self.Color
                    PressedFill: =RGBA(0, 0, 0, 0)
                    TabIndex: =0
                    Tooltip: ="View next month"
                    Width: =59
                    X: =360
                    Y: =80
                    ZIndex: =3

        conShiftCalendar_CalendarComp As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.Light
            FillPortions: =0
            Height: =Parent.Height - conMonthHeader_CalendarComp.Height - Parent.PaddingTop - Parent.PaddingBottom
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutMaxHeight: =
            LayoutMaxWidth: =
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            LayoutOverflowY: =LayoutOverflow.Scroll
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            ZIndex: =2

            conCalendarMain_CalendarComp As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                DropShadow: =DropShadow.Light
                FillPortions: =0.9
                Height: |-
                    =//Parent.Height
                    galCalendar_CalendarComp.Height + galWeekday_CalendarComp.Height
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMaxHeight: =
                LayoutMaxWidth: =
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                ZIndex: =1

                galWeekday_CalendarComp As gallery.WeekdayGallery:
                    '#CopilotOverlayLabel': ="Filtered"
                    AccessibleLabel: ="Days of the week"
                    AlignInContainer: =AlignInContainer.SetByContainer
                    BorderColor: =RGBA(166, 166, 166, 1)
                    FillPortions: =0
                    FocusedBorderColor: =ColorValue(varTheme.statusInformative)
                    Height: =45
                    Items: =Calendar.WeekdaysShort()
                    LayoutMaxHeight: =
                    LayoutMaxWidth: =
                    LayoutMinHeight: =40
                    LayoutMinWidth: =290
                    OnSelect: =
                    ShowScrollbar: =false
                    TabIndex: =0
                    TemplatePadding: =0
                    TemplateSize: =galWeekday_CalendarComp.Width/7
                    Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                    X: =46
                    Y: =139
                    ZIndex: =1

                    shpWeekdaySeparator_CalendarComp As rectangle:
                        AccessibleLabel: ="Calendar line divider for weekdays and days"
                        BorderColor: =App.Theme.Colors.Darker40
                        Fill: =App.Theme.Colors.Primary
                        Height: =2
                        OnSelect: =
                        Width: =Parent.Width
                        X: =10
                        Y: =Parent.Height - Self.Height
                        ZIndex: =1

                    lblWeekdayHeader_CalendarComp As Text:
                        Align: ='TextCanvas.Align'.Center
                        AutoHeight: =true
                        BorderColor: =
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        Fill: =
                        FontColor: =ColorValue(varTheme.neutralForeground3)
                        Height: =
                        Size: =
                        Text: =ThisItem.Value
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =galWeekday_CalendarComp.TemplateWidth
                        X: =0
                        Y: =(galWeekday_CalendarComp.TemplateHeight - Self.Height) / 2
                        ZIndex: =2

                galCalendar_CalendarComp As gallery.galleryVertical:
                    '#CopilotOverlayLabel': ="Filtered"
                    AccessibleLabel: ="A calendar showing dates for the selected month"
                    AlignInContainer: =AlignInContainer.SetByContainer
                    BorderColor: =RGBA(166, 166, 166, 1)
                    DelayItemLoading: =true
                    FillPortions: =0
                    FocusedBorderColor: =ColorValue(varTheme.statusInformative)
                    Height: =430
                    Items: =colCalendarValues
                    Layout: =Layout.Vertical
                    LayoutMaxHeight: =
                    LayoutMaxWidth: =
                    LayoutMinHeight: =100
                    LayoutMinWidth: =320
                    LoadingSpinner: =LoadingSpinner.Data
                    OnSelect: |+
                        =
                        Set(varDateSelected, DateAdd(varFirstDayInView, ThisItem.Value, TimeUnit.Days));
                        //If the date is outside of this month
                        //If(//If date is in next month
                        //    varDateSelected > varLastDayOfMonth, /*changes month view to next month*/
                        Set(varFirstDayOfMonth, DateAdd(varFirstDayOfMonth, 1, TimeUnit.Months));
                        Set(varFirstDayInView, DateAdd(varFirstDayOfMonth, -(Weekday(varFirstDayOfMonth) - 2 + 1), TimeUnit.Days));
                        /*collects calendar events for all days in current month view. Updates varMaxDate to prevent duplicate data collection if user returns to this month view*/
                        Set(varLastDayOfMonth, DateAdd(DateAdd(varFirstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
                        //If(varLastDayOfMonth > varMaxDate, Set(varMaxDate, varLastDayOfMonth); ClearCollect(colMyCalendarEvents, Filter(colAllMyCalendarEvents, 'Reservation Date' < varMaxDate, 'Reservation Date' > varMinDate)));, 
                        //If date is in previous month
                        //varDateSelected < varFirstDayOfMonth, 
                        /*changes month view to previous month*/
                        Set(varFirstDayOfMonth, DateAdd(varFirstDayOfMonth, -1, TimeUnit.Months));
                        Set(varFirstDayInView, DateAdd(varFirstDayOfMonth, -(Weekday(varFirstDayOfMonth) - 2 + 1), TimeUnit.Days));
                        Set(varLastDayOfMonth, DateAdd(DateAdd(varFirstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
                        /*collects calendar events for all days in current month view. Updates varMinDate to prevent duplicate data collection if user returns to this month view*/
                        //If(varMinDate > varFirstDayOfMonth, Set(varMinDate, varFirstDayOfMonth);ClearCollect(colMyCalendarEvents, Filter(colAllMyCalendarEvents, 'Reservation Date' < varMaxDate, 'Reservation Date' > varMinDate))););
                        
                    ShowScrollbar: =false
                    TabIndex: =0
                    TemplateFill: |-
                        =If(
                            IsNumeric(btnDate_CalendarComp.Text),
                            If(
                                /*The day is outside the range of the currently selected month*/
                                Abs(btnDate_CalendarComp.Text - ThisItem.Value) > 10, ColorValue(varTheme.neutralBackgroundDisabled), RGBA(0, 0, 0, 0)
                            )
                        )
                    TemplateSize: =65
                    Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                    WrapCount: =7
                    X: =46
                    Y: =45
                    ZIndex: =2

                    hdnDateMetrics_CalendarComp As Text:
                        Align: ="Start"
                        AutoHeight: =false
                        BorderColor: =
                        BorderStyle: =""
                        ContentLanguage: =""
                        DisplayMode: =DisplayMode.Edit
                        Fill: =
                        Font: =""
                        FontColor: =
                        FontItalic: =false
                        FontStrikethrough: =false
                        FontUnderline: =false
                        Height: =32
                        Size: =14
                        TabIndex: =0
                        Text: |-
                            =If(btnDate_CalendarComp.DisplayMode = DisplayMode.Disabled,
                            "||",
                            With(
                                {
                                    TodaysBookings : Filter(
                                              AddColumns(
                                                colFilteredBookings As Booking,
                                                ResourceName,
                                                Booking.Resource
                                              ),
                                              DateValue(Date) = DateAdd(varFirstDayInView,ThisItem.Value, TimeUnit.Days) && Status  = 'Status (shiftplanner_shiftbookings)'.Active
                                    )
                                },
                                    Concatenate(
                                        // Find the count of the bookings
                                        CountRows(
                                           Filter(
                                              TodaysBookings,
                                              !IsBlank(Resource)
                                           )
                                        ), 
                                        "|"
                                        ,
                                        // Find all the rows that need bookings
                                        CountRows(TodaysBookings), "|", First(TodaysBookings).'Status Reason' 
                                    )
                            )
                            )
                        Tooltip: =""
                        VerticalAlign: =""
                        Visible: =false
                        Weight: ="Regular"
                        Width: =96
                        Wrap: =true
                        X: =0
                        Y: =33
                        ZIndex: =2

                    shpCircle_CalendarComp As circle:
                        BorderColor: |-
                            =//RGBA(166, 166, 166, 1)
                            App.Theme.Colors.Primary
                        BorderThickness: |-
                            =If(
                                /*Date selected is this date*/
                                DateAdd(varFirstDayInView, ThisItem.Value) = varDateSelected, 1, 0)
                        Fill: |-
                            =If(DateAdd(varFirstDayInView, ThisItem.Value) = Today(),
                                App.Theme.Colors.Primary,
                                ColorValue(varTheme.neutralBackground2))
                        FocusedBorderColor: =ColorValue(varTheme.statusInformative)
                        Height: =Self.Width
                        OnSelect: =Select(Parent)
                        Visible: |-
                            =/*Visible if calendar events are found on this day*/               
                            If(
                                /*Date selected is this date*/
                                DateAdd(varFirstDayInView, ThisItem.Value) = varDateSelected || DateAdd(varFirstDayInView, ThisItem.Value) = Today(), true, false)
                        Width: =33
                        X: |-
                            =//(Parent.TemplateWidth/2) - (Self.Width/2)
                            (galCalendar_CalendarComp.TemplateWidth - Self.Width) / 2
                        Y: |-
                            =//galCalendar_CalendarComp.TemplateHeight * (0.75)
                            4
                        ZIndex: =3

                    btnDate_CalendarComp As Button:
                        AccessibleLabel: ="Selected Date Button"
                        Align: =""
                        Appearance: ='ButtonCanvas.Appearance'.Transparent
                        BasePaletteColor: =
                        BorderColor: =
                        BorderStyle: =""
                        DisplayMode: |-
                            =If(
                                //All days before the start of current week should be disabled
                                (Today() - Weekday(
                                    Today(),
                                    StartOfWeek.Sunday
                                ) + 1) > DateAdd(
                                    varFirstDayInView,
                                    ThisItem.Value,
                                    TimeUnit.Days
                                ) || //All days after 8 weeks from current week should be disabled
                                (DateAdd(
                                    (Today() - Weekday(
                                        Today(),
                                        StartOfWeek.Sunday
                                    )),
                                    ActiveBookingWindowDays,
                                    TimeUnit.Days
                                )) < DateAdd(
                                    varFirstDayInView,
                                    ThisItem.Value,
                                    TimeUnit.Days
                                ),
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        FontColor: |-
                            =If(
                                IsNumeric(Self.Text) And IsNumeric(Self.Text),
                                If(
                                    /*Today when it is not selected*/
                                    DateAdd(varFirstDayInView, ThisItem.Value) = Today(), App.Theme.Colors.Lighter80,
                                    /*Date selected is this date*/
                                    DateAdd(varFirstDayInView, ThisItem.Value) = varDateSelected, App.Theme.Colors.Primary, 
                                    /*The day is outside the range of the currently selected month*/
                                    Abs(Self.Text - ThisItem.Value) > 10, App.Theme.Colors.Darker70, App.Theme.Colors.Darker70)
                            )
                        Height: =galCalendar_CalendarComp.TemplateHeight - 25
                        Icon: =""
                        IconRotation: =0
                        IconStyle: ="Outline"
                        Layout: ="Icon before"
                        OnSelect: |
                            =Set(varDateSelected, DateAdd(varFirstDayInView, ThisItem.Value, TimeUnit.Days));
                            
                            //If the date is outside of this month
                            If(//If date is in next month
                                varDateSelected > varLastDayOfMonth, 
                                
                                /*changes month view to next month*/
                                Set(varFirstDayOfMonth, DateAdd(varFirstDayOfMonth, 1, TimeUnit.Months));
                                Set(varFirstDayInView, DateAdd(varFirstDayOfMonth, -(Weekday(varFirstDayOfMonth) - 2 + 1), TimeUnit.Days));
                                /*collects calendar events for all days in current month view. Updates varMaxDate to prevent duplicate data collection if user returns to this month view*/
                                Set(varLastDayOfMonth, DateAdd(DateAdd(varFirstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
                                If(varLastDayOfMonth > varMaxDate, Set(varMaxDate, varLastDayOfMonth));
                                ,
                            
                                //If date is in previous month
                                varDateSelected < varFirstDayOfMonth, 
                                /*changes month view to previous month*/
                                Set(varFirstDayOfMonth, DateAdd(varFirstDayOfMonth, -1, TimeUnit.Months));
                                Set(varFirstDayInView, DateAdd(varFirstDayOfMonth, -(Weekday(varFirstDayOfMonth) - 2 + 1), TimeUnit.Days));
                                Set(varLastDayOfMonth, DateAdd(DateAdd(varFirstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
                                
                                /*collects calendar events for all days in current month view. Updates varMinDate to prevent duplicate data collection if user returns to this month view*/
                                If(varMinDate > varFirstDayOfMonth, Set(varMinDate, varFirstDayOfMonth));
                            );
                        Text: =Day(DateAdd(varFirstDayInView, ThisItem.Value, TimeUnit.Days))
                        VerticalAlign: =""
                        Width: =Self.Height
                        X: =(galCalendar_CalendarComp.TemplateWidth - Self.Width) / 2
                        Y: =0
                        ZIndex: =4

                    conStatusCount_CalendarComp As groupContainer.horizontalAutoLayoutContainer:
                        Height: =galCalendar_CalendarComp.TemplateHeight - 40
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutGap: =5
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMode: =LayoutMode.Auto
                        PaddingLeft: =10
                        PaddingRight: =5
                        RadiusBottomLeft: =4
                        RadiusBottomRight: =4
                        RadiusTopLeft: =4
                        RadiusTopRight: =4
                        Width: =galCalendar_CalendarComp.TemplateWidth
                        X: =(galCalendar_CalendarComp.TemplateWidth - Self.Width) / 2
                        Y: =40
                        ZIndex: =5

                        shpCircleDayStatus_CalendarComp As circle:
                            AccessibleLabel: ="Published/Unpublished Status"
                            BorderColor: =RGBA(166, 166, 166, 1)
                            Fill: =ColorValue(varTheme.statusSuccess)
                            FocusedBorderColor: =ColorValue(varTheme.statusSuccess)
                            Height: =Self.Width
                            LayoutMaxHeight: =
                            LayoutMaxWidth: =
                            OnSelect: =
                            Visible: |-
                                =Last(Split(hdnDateMetrics_CalendarComp.Text, "|")).Value = "Published"
                                /*
                                With(
                                    {
                                        DayDate: DateAdd(
                                            varFirstDayInView,
                                            ThisItem.Value,
                                            TimeUnit.Days
                                        )
                                    },
                                    If(
                                        First(
                                            Filter(
                                                AddColumns(
                                                    colFilteredBookings As Booking,
                                                    BookingDate,
                                                    Booking.Date
                                                ),
                                                DateValue(BookingDate) = DayDate And Status = 'Status (shiftplanner_shiftbookings)'.Active
                                            )
                                        ).'Status Reason' = 'Status Reason (shiftplanner_shiftbookings)'.Published && lblCount_CalendarComp.Text <> "",
                                        true,
                                        false
                                    )
                                )*/
                            Width: =5
                            X: =
                            Y: =
                            ZIndex: =1

                        lblCount_CalendarComp As Text:
                            Align: ='TextCanvas.Align'.Start
                            BorderColor: =
                            BorderStyle: =""
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =Parent.Height
                            LayoutMaxHeight: =
                            LayoutMaxWidth: =
                            LayoutMinHeight: =32
                            LayoutMinWidth: =60
                            Text: |-
                                =If(
                                    !IsBlank(First(Split(hdnDateMetrics_CalendarComp.Text, "|")).Value),
                                    Concatenate(
                                        First(Split(hdnDateMetrics_CalendarComp.Text, "|")).Value,
                                        " of ",
                                        Last(FirstN(Split(hdnDateMetrics_CalendarComp.Text, "|"), 2)).Value
                                    )
                                )
                                
                                
                                /*
                                With(
                                    {
                                        TodaysBookings : Filter(
                                                  AddColumns(
                                                    colFilteredBookings As Booking,
                                                    ResourceName,
                                                    Booking.Resource
                                                  ),
                                                  DateValue(Date) = DateAdd(varFirstDayInView,ThisItem.Value, TimeUnit.Days) && Status  = 'Status (shiftplanner_shiftbookings)'.Active
                                        )
                                    },
                                        Concatenate(
                                            // Find the count of the bookings
                                            CountRows(
                                               Filter(
                                                  TodaysBookings,
                                                  !IsBlank(Resource)
                                               )
                                            ), 
                                            " of "
                                            ,
                                            // Find all the rows that need bookings
                                            CountRows(TodaysBookings)
                                        )
                                )*/
                            VerticalAlign: =VerticalAlign.Middle
                            Visible: =!EndsWith(lblCount_CalendarComp.Text, "of 0")
                            Width: =65
                            Wrap: =true
                            X: =(galCalendar_CalendarComp.TemplateWidth - Self.Width) / 2
                            Y: =0
                            ZIndex: =2

            conWeekStatusColumn_CalendarComp As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                FillPortions: =0.1
                Height: =lblWeekStatusLabel_CalendarComp.Height + galWeekStatus_CalendarComp.Height
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMaxHeight: =
                LayoutMaxWidth: =
                LayoutMinHeight: =100
                LayoutMinWidth: =150
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                ZIndex: =2

                lblWeekStatusLabel_CalendarComp As Text:
                    Align: ='TextCanvas.Align'.Center
                    AlignInContainer: =AlignInContainer.Start
                    BorderColor: =
                    BorderStyle: =""
                    DisplayMode: =DisplayMode.Edit
                    Fill: =
                    FontColor: =
                    Height: =galWeekday_CalendarComp.Height - 2
                    LayoutMaxHeight: =
                    LayoutMaxWidth: =
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    Size: =
                    Text: ="Week Status"
                    VerticalAlign: =VerticalAlign.Middle
                    Weight: =varThemeFont.H3.weightBold
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =1

                shpWeekStatusSeparator_CalendarComp As rectangle:
                    AccessibleLabel: ="Right pane header divider"
                    BorderColor: =App.Theme.Colors.Darker40
                    Fill: =App.Theme.Colors.Primary
                    Height: =2
                    LayoutMaxHeight: =
                    LayoutMaxWidth: =
                    OnSelect: =
                    Width: =Parent.Width - 10
                    Y: =Parent.Height - Self.Height
                    ZIndex: =2

                "galWeekStatus_CalendarComp As gallery.'BrowseLayout_Vertical_OneTextVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtered"
                    AccessibleLabel: ="A calendar showing dates for the selected month"
                    AlignInContainer: =AlignInContainer.SetByContainer
                    BorderColor: =App.Theme.Colors.Darker40
                    DelayItemLoading: =true
                    FillPortions: =0
                    FocusedBorderColor: =ColorValue(varTheme.statusInformative)
                    Height: =galCalendar_CalendarComp.Height
                    Items: =[1,2,3,4,5,6]
                    Layout: =Layout.Vertical
                    LayoutMaxHeight: =
                    LayoutMaxWidth: =
                    LayoutMinHeight: =200
                    LayoutMinWidth: =100
                    LoadingSpinner: =LoadingSpinner.Data
                    OnSelect: |
                        =Set(varDateSelected, DateAdd(varFirstDayInView, ThisItem.Value, TimeUnit.Days));
                        //If the date is outside of this month
                        //If(//If date is in next month
                        //    varDateSelected > varLastDayOfMonth, /*changes month view to next month*/
                        Set(varFirstDayOfMonth, DateAdd(varFirstDayOfMonth, 1, TimeUnit.Months));
                        Set(varFirstDayInView, DateAdd(varFirstDayOfMonth, -(Weekday(varFirstDayOfMonth) - 2 + 1), TimeUnit.Days));
                        /*collects calendar events for all days in current month view. Updates varMaxDate to prevent duplicate data collection if user returns to this month view*/
                        Set(varLastDayOfMonth, DateAdd(DateAdd(varFirstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
                        //If(varLastDayOfMonth > varMaxDate, Set(varMaxDate, varLastDayOfMonth); ClearCollect(colMyCalendarEvents, Filter(colAllMyCalendarEvents, 'Reservation Date' < varMaxDate, 'Reservation Date' > varMinDate)));, 
                        //If date is in previous month
                        //varDateSelected < varFirstDayOfMonth, 
                        /*changes month view to previous month*/
                        Set(varFirstDayOfMonth, DateAdd(varFirstDayOfMonth, -1, TimeUnit.Months));
                        Set(varFirstDayInView, DateAdd(varFirstDayOfMonth, -(Weekday(varFirstDayOfMonth) - 2 + 1), TimeUnit.Days));
                        Set(varLastDayOfMonth, DateAdd(DateAdd(varFirstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
                        /*collects calendar events for all days in current month view. Updates varMinDate to prevent duplicate data collection if user returns to this month view*/
                        //If(varMinDate > varFirstDayOfMonth, Set(varMinDate, varFirstDayOfMonth);ClearCollect(colMyCalendarEvents, Filter(colAllMyCalendarEvents, 'Reservation Date' < varMaxDate, 'Reservation Date' > varMinDate))););
                    ShowScrollbar: =false
                    TabIndex: =0
                    TemplateFill: |-
                        =//If(
                            /*Date selected is this date*/
                            //DateAdd(varFirstDayInView, ThisItem.Value) = varDateSelected, App.Theme.Colors.Primary, 
                            /*The day is outside the range of the currently selected month*/
                         //   Abs(btnDate_Calendar_1.Text - ThisItem.Value) > 10, ColorValue(varTheme.backgroundFillDisabled), RGBA(0, 0, 0, 0))
                    TemplateSize: =65
                    Width: =Parent.Width 
                    X: =46
                    Y: =45
                    ZIndex: =3

                    shpSeparator_CalendarComp As rectangle:
                        AccessibleLabel: ="Week divider"
                        BorderColor: =App.Theme.Colors.Darker40
                        Fill: =RGBA(214, 221, 224, 1)
                        Height: =1
                        OnSelect: =
                        Width: =Parent.TemplateWidth - 5
                        Y: =Parent.TemplateHeight - Self.Height
                        ZIndex: =1

                    btnPublishButton_CalendarComp As Button:
                        AccessibleLabel: ="Published/Unpublished Button"
                        Align: =""
                        Appearance: ='ButtonCanvas.Appearance'.Secondary
                        BasePaletteColor: =
                        BorderColor: =
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        FontColor: =
                        Height: =24
                        Icon: =""
                        IconRotation: =0
                        IconStyle: ="Outline"
                        Layout: ="Icon before"
                        OnSelect: |-
                            =Set(varPublishStatus, lblPublishedStatusLabel_CalendarComp.Text);
                            Set(varSelectedWeek, DateAdd(varFirstDayOfMonth, (7 * (ThisItem.Value - 1)), TimeUnit.Days));
                            Navigate(compCalendar.ConfirmationScreen, ScreenTransition.Fade);
                        Text: |-
                            =With(
                                {
                                    PublishText: "Publish",
                                    UnpublishText: "Unpublish"
                                },
                                If(lblPublishedStatusLabel_CalendarComp.Text = "Published",
                                    UnpublishText,
                                    PublishText
                                )
                            )
                        VerticalAlign: =""
                        Width: =shpCircleStatus_CalendarComp.Width + lblPublishedStatusLabel_CalendarComp.Width + conPublishedStatus_CalendarComp.LayoutGap
                        X: |-
                            =//(galWeekStatus_CalendarComp.TemplateWidth - Self.Width) / 2
                            shpCircleStatus_CalendarComp.X - conPublishedStatus_CalendarComp.LayoutGap
                        Y: =30
                        ZIndex: =2

                    conPublishedStatus_CalendarComp As groupContainer.horizontalAutoLayoutContainer:
                        Height: =lblPublishedStatusLabel_CalendarComp.Height
                        LayoutGap: =5
                        LayoutJustifyContent: =LayoutJustifyContent.Center
                        LayoutMode: =LayoutMode.Auto
                        RadiusBottomLeft: =4
                        RadiusBottomRight: =4
                        RadiusTopLeft: =4
                        RadiusTopRight: =4
                        Width: =Parent.Width
                        X: =(galWeekStatus_CalendarComp.TemplateWidth - Self.Width) / 2
                        ZIndex: =3

                        shpCircleStatus_CalendarComp As circle:
                            AccessibleLabel: ="Published/Unpublished Status"
                            AlignInContainer: =AlignInContainer.Center
                            BorderColor: =RGBA(166, 166, 166, 1)
                            Fill: |-
                                =If(lblPublishedStatusLabel_CalendarComp.Text = "Published",
                                    ColorValue(varTheme.statusSuccess),
                                    Color.Gray
                                )
                            FocusedBorderColor: =ColorValue(varTheme.statusInformative)
                            Height: =Self.Width
                            LayoutMaxHeight: =
                            LayoutMaxWidth: =
                            OnSelect: =
                            Width: =14
                            X: |-
                                =//(Parent.TemplateWidth/2) - (Self.Width/2)
                                //(galCalendar_CalendarComp.TemplateWidth - Self.Width) / 2
                            Y: |-
                                =//galCalendar_CalendarComp.TemplateHeight * (0.75)
                                4
                            ZIndex: =1

                        lblPublishedStatusLabel_CalendarComp As Text:
                            AutoHeight: =false
                            BorderColor: =
                            BorderStyle: =""
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =ColorValue(varTheme.neutralForeground1)
                            Height: =20
                            LayoutMaxHeight: =
                            LayoutMaxWidth: =
                            LayoutMinHeight: =32
                            LayoutMinWidth: =96
                            Size: =
                            Text: |+
                                =With(
                                    {
                                        //Get the day after adding the number of weeks the current row is to the first day of the month
                                        WeekAfterFirstDay: DateAdd(
                                            varFirstDayOfMonth,
                                            (7 * (ThisItem.Value - 1)),
                                            TimeUnit.Days
                                        )
                                    },
                                    If(
                                        //Check first if there are any active bookings for this zone on that Day, if none, display Unpublished, otherwise check status
                                        IsEmpty(
                                            Filter(
                                                AddColumns(
                                                    colFilteredBookings As Booking,
                                                    BookingDate,
                                                    Booking.Date
                                                ),
                                                DateValue(BookingDate) > (WeekAfterFirstDay - Weekday(WeekAfterFirstDay)) && DateValue(Date) <= ((WeekAfterFirstDay - Weekday(WeekAfterFirstDay)) + 7)
                                            )
                                        ),
                                        'Status Reason (shiftplanner_shiftbookings)'.Unpublished,
                                        //Check if there are any records with Unpublished Status; if none, week status is Published, if yes, week status is Unpublished
                                        If (
                                            IsEmpty(
                                                Filter(
                                                    AddColumns(
                                                        colFilteredBookings As Booking,
                                                        BookingDate,
                                                        Booking.Date
                                                    ),
                                                    DateValue(BookingDate) > (WeekAfterFirstDay - Weekday(WeekAfterFirstDay)) && DateValue(Date) <= ((WeekAfterFirstDay - Weekday(WeekAfterFirstDay)) + 7) && 'Status Reason' = 'Status Reason (shiftplanner_shiftbookings)'.Unpublished
                                                )
                                            ),
                                            'Status Reason (shiftplanner_shiftbookings)'.Published,
                                            'Status Reason (shiftplanner_shiftbookings)'.Unpublished
                                        )
                                    )
                                )
                                
                            VerticalAlign: =VerticalAlign.Top
                            Weight: =varThemeFont.H3.weightBold
                            Width: =96
                            Wrap: =false
                            X: =0
                            Y: =0
                            ZIndex: =2

