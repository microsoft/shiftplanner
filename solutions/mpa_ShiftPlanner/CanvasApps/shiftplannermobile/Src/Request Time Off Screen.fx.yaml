"'Request Time Off Screen' As screen":
    Fill: =Color.White
    LoadingSpinnerColor: =App.Theme.Colors.Primary
    OnVisible: =Reset(txiReason_RequestTimeOff);

    conMainContent_RequestTimeOff As groupContainer.verticalAutoLayoutContainer:
        Fill: =ColorValue(varTheme.neutralBackground2)
        Height: =Parent.Height - cmpHeaderMobile_RequestTimeOff.Height
        LayoutDirection: =LayoutDirection.Vertical
        LayoutGap: =2
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        PaddingLeft: |-
            =Switch(App.ActiveScreen.Size,
            5, (App.Width - 1580)/2,
            4, 20,
            3, 20,
            2, 20,
            1, 20
            )
        PaddingRight: |-
            =Switch(App.ActiveScreen.Size,
            5, (App.Width - 1580)/2,
            4, 20,
            3, 20,
            2, 20,
            1, 20
            )
        PaddingTop: =2
        Width: =Parent.Width
        Y: =cmpHeaderMobile_RequestTimeOff.Y + cmpHeaderMobile_RequestTimeOff.Height
        ZIndex: =1

        conBodyContent_RequestTimeOff As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.Light
            Fill: =ColorValue(varTheme.neutralBackground1)
            FillPortions: =0
            Height: =Parent.Height - Parent.PaddingTop - conButtons_RequestTimeOff.Height - Parent.LayoutGap
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =16
            LayoutMaxHeight: =
            LayoutMaxWidth: =
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            LayoutOverflowY: =LayoutOverflow.Scroll
            PaddingBottom: =20
            PaddingLeft: =16
            PaddingRight: =16
            PaddingTop: =20
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
            ZIndex: =2

            conDetails_RequestTimeOff As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                Fill: =ColorValue(varTheme.neutralBackground1)
                LayoutDirection: =LayoutDirection.Vertical
                LayoutGap: =24
                LayoutMaxHeight: =
                LayoutMaxWidth: =
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                ZIndex: =2

                conRequestTimeOffDate_RequestTimeOff As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    Fill: =ColorValue(varTheme.neutralBackground1)
                    FillPortions: =0
                    Height: =txtRequestTimeOffDate_RequestTimeOff.Height + Self.LayoutGap + txtRequestTimeOffDateValue_RequestTimeOff.Height + Self.LayoutGap + txtRequestTimeOffShiftName_RequestTimeOff.Height + Self.LayoutGap + txtRequestTimeOffShiftTime_RequestTimeOff.Height
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =4
                    LayoutMaxHeight: =
                    LayoutMaxWidth: =
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    Width: =Parent.Width
                    ZIndex: =2

                    txtRequestTimeOffDate_RequestTimeOff As Text:
                        AutoHeight: =true
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        FontColor: =ColorValue(varTheme.neutralForeground1)
                        Height: =32
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        Text: ="Schedule"
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                        X: =0
                        Y: =0
                        ZIndex: =1

                    txtRequestTimeOffDateValue_RequestTimeOff As Text:
                        AutoHeight: =true
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        FontColor: =ColorValue(varTheme.primary)
                        Height: =28
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        LayoutMinHeight: =28
                        LayoutMinWidth: =96
                        Size: =20
                        Text: =Text(varSelectedShift.Date, "mmmm dd, yyyy")
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                        X: =0
                        Y: =0
                        ZIndex: =2

                    txtRequestTimeOffShiftName_RequestTimeOff As Text:
                        AutoHeight: =true
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        FontColor: =ColorValue(varTheme.neutralForeground1)
                        Height: =32
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        Text: =varSelectedShift.'Team Position'.'Shift Team'.'Shift Type'.Name
                        Weight: ='TextCanvas.Weight'.Regular
                        Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                        X: =0
                        Y: =0
                        ZIndex: =3

                    txtRequestTimeOffShiftTime_RequestTimeOff As Text:
                        AutoHeight: =true
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        FontColor: =ColorValue(varTheme.neutralForeground1)
                        Height: =32
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        Text: =Concatenate(Text(varSelectedShift.'Team Position'.'Shift Team'.'Shift Type'.Startdate , DateTimeFormat.ShortTime) & " - " & Text(varSelectedShift.'Team Position'.'Shift Team'.'Shift Type'.Enddate, DateTimeFormat.ShortTime))
                        Weight: ='TextCanvas.Weight'.Regular
                        Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                        X: =0
                        Y: =0
                        ZIndex: =4

                conReason_RequestTimeOff As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    Fill: =ColorValue(varTheme.neutralBackground1)
                    FillPortions: =0
                    Height: =txtReason_RequestTimeOff.Height + Self.LayoutGap + txiReason_RequestTimeOff.Height
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =8
                    LayoutMaxHeight: =
                    LayoutMaxWidth: =
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    Width: =Parent.Width
                    ZIndex: =4

                    txtReason_RequestTimeOff As Text:
                        AutoHeight: =true
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        FontColor: =ColorValue(varTheme.neutralForeground1)
                        Height: =32
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        Text: ="Reason"
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                        X: =0
                        Y: =0
                        ZIndex: =1

                    "txiReason_RequestTimeOff As 'Text input'":
                        AccessibleLabel: ="Text Input"
                        Appearance: ='TextInputCanvas.Appearance'.Outline
                        BasePaletteColor: =
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        Font: =""
                        FontColor: =
                        FontItalic: =
                        FontSize: =0
                        FontWeight: =""
                        Height: =200
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        LayoutMinHeight: =32
                        LayoutMinWidth: =320
                        Mode: ='TextInputCanvas.Mode'.Multiline
                        Placeholder: =
                        TriggerOutput: ="FocusOut"
                        Type: ='TextInputCanvas.Type'.Text
                        Width: =Parent.Width
                        X: =0
                        Y: =0
                        ZIndex: =3

        conButtons_RequestTimeOff As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            Fill: =ColorValue(varTheme.neutralBackground2)
            FillPortions: =0
            Height: =56
            LayoutGap: =12
            LayoutJustifyContent: =LayoutJustifyContent.Center
            LayoutMaxHeight: =
            LayoutMaxWidth: =
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingBottom: =12
            PaddingTop: =12
            Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
            ZIndex: =3

            btnBack_RequestTimeOff As Button:
                AccessibleLabel: ="Secondary"
                Align: =""
                Appearance: ='ButtonCanvas.Appearance'.Secondary
                BasePaletteColor: =
                BorderStyle: =""
                DisplayMode: =DisplayMode.Edit
                Font: =""
                FontColor: =
                FontItalic: =
                FontSize: =0
                FontWeight: =""
                Height: =32
                Icon: =""
                IconRotation: =0
                IconStyle: ="Outline"
                Layout: ="Icon before"
                LayoutMaxHeight: =
                LayoutMaxWidth: =
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                OnSelect: =Back()
                Text: ="Back"
                VerticalAlign: =""
                Width: =170
                X: =0
                Y: =0
                ZIndex: =1

            btnSubmit_RequestTimeOff As Button:
                AccessibleLabel: ="Primary"
                Align: =""
                Appearance: ='ButtonCanvas.Appearance'.Primary
                BasePaletteColor: =
                BorderStyle: =""
                DisplayMode: =If(IsBlank(txiReason_RequestTimeOff.Value) || Len(Trim(txiReason_RequestTimeOff.Value))<=0, DisplayMode.Disabled,DisplayMode.Edit)
                Font: =""
                FontColor: =
                FontItalic: =
                FontSize: =0
                FontWeight: =""
                Height: =32
                Icon: =""
                IconRotation: =0
                IconStyle: ="Outline"
                Layout: ="Icon before"
                LayoutMaxHeight: =
                LayoutMaxWidth: =
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                OnSelect: |
                    =IfError(
                        //Insert new record to change request
                        Patch(
                            'Change Requests',
                            Defaults('Change Requests'),
                            {
                                Resource: LookUp(
                                    Users,
                                    'Primary Email' = varCurrentUser.Email
                                ),
                                //'New Resource': varSelectedTeamPosition.Resource,
                                Reason: txiReason_RequestTimeOff.Value,
                                'Shift Booking': varSelectedShift,
                                //'Swap With': varSelectedTeamPosition,
                                'Change Type': 'Change type'.'Time off'
                            }
                        );
                        //Update Shift Booking Workflow Status
                        Patch(
                            'Shift Bookings',
                            LookUp(
                                'Shift Bookings',
                                shiftplanner_shiftbooking = varSelectedShift.shiftplanner_shiftbooking
                            ),
                            {'Workflow Status': 'Workflow Status (Shift Bookings)'.Yes}
                        );
                        Navigate('Shift Details Screen');
                        ,
                        Notify(
                            "Error inserting record.",
                            NotificationType.Error
                        ),
                        Notify(
                            "Request has been submitted",
                            NotificationType.Success
                        )
                    );
                Text: ="Submit"
                VerticalAlign: =""
                Width: =170
                X: =0
                Y: =0
                ZIndex: =3

    cmpHeaderMobile_RequestTimeOff As compHeaderMobile:
        BackScreen: ='Home Screen'
        HeaderTitle: ="Request Time Off"
        HomeScreen: ='Home Screen'
        NavigationScreen: ='Navigation Screen'
        TeamsEmbeddedMode: =varIsTeamsEmbedded
        ZIndex: =2

