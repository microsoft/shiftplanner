# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  Request Time Off Screen:
    Properties:
      OnVisible: =Reset(txiReason_RequestTimeOff);
    Children:
      - conMainContent_RequestTimeOff:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            DropShadow: =DropShadow.None
            Fill: =ColorValue(varTheme.neutralBackground2)
            Height: =Parent.Height - cmpHeaderMobile_RequestTimeOff.Height
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =2
            LayoutOverflowY: =LayoutOverflow.Scroll
            PaddingLeft: |-
              =Switch(App.ActiveScreen.Size,
              5, (App.Width - 1580)/2,
              4, 20,
              3, 20,
              2, 20,
              1, 20
              )
            PaddingRight: |-
              =Switch(App.ActiveScreen.Size,
              5, (App.Width - 1580)/2,
              4, 20,
              3, 20,
              2, 20,
              1, 20
              )
            PaddingTop: =2
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =Parent.Width
            Y: =cmpHeaderMobile_RequestTimeOff.Y + cmpHeaderMobile_RequestTimeOff.Height
          Children:
            - conBodyContent_RequestTimeOff:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  Fill: =ColorValue(varTheme.neutralBackground1)
                  FillPortions: =0
                  Height: =Parent.Height - Parent.PaddingTop - conButtons_RequestTimeOff.Height - Parent.LayoutGap
                  LayoutDirection: =LayoutDirection.Vertical
                  LayoutGap: =16
                  LayoutOverflowY: =LayoutOverflow.Scroll
                  PaddingBottom: =20
                  PaddingLeft: =16
                  PaddingRight: =16
                  PaddingTop: =20
                  Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                Children:
                  - conDetails_RequestTimeOff:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        Fill: =ColorValue(varTheme.neutralBackground1)
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =24
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                      Children:
                        - conRequestTimeOffDate_RequestTimeOff:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              AlignInContainer: =AlignInContainer.SetByContainer
                              DropShadow: =DropShadow.None
                              Fill: =ColorValue(varTheme.neutralBackground1)
                              FillPortions: =0
                              Height: =txtRequestTimeOffDate_RequestTimeOff.Height + Self.LayoutGap + txtRequestTimeOffDateValue_RequestTimeOff.Height + Self.LayoutGap + txtRequestTimeOffShiftName_RequestTimeOff.Height + Self.LayoutGap + txtRequestTimeOffShiftTime_RequestTimeOff.Height
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutGap: =4
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Parent.Width
                            Children:
                              - txtRequestTimeOffDate_RequestTimeOff:
                                  Control: Text@0.0.51
                                  Properties:
                                    AutoHeight: =true
                                    FontColor: =ColorValue(varTheme.neutralForeground1)
                                    Text: ="Schedule"
                                    Weight: ='TextCanvas.Weight'.Semibold
                                    Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                              - txtRequestTimeOffDateValue_RequestTimeOff:
                                  Control: Text@0.0.51
                                  Properties:
                                    AutoHeight: =true
                                    FontColor: =ColorValue(varTheme.primary)
                                    Height: =28
                                    LayoutMinHeight: =28
                                    Size: =20
                                    Text: =Text(varSelectedShift.Date, "mmmm dd, yyyy")
                                    Weight: ='TextCanvas.Weight'.Semibold
                                    Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                              - txtRequestTimeOffShiftName_RequestTimeOff:
                                  Control: Text@0.0.51
                                  Properties:
                                    AutoHeight: =true
                                    FontColor: =ColorValue(varTheme.neutralForeground1)
                                    Text: =varSelectedShift.'Team Position'.'Shift Team'.'Shift Type'.Name
                                    Weight: ='TextCanvas.Weight'.Regular
                                    Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                              - txtRequestTimeOffShiftTime_RequestTimeOff:
                                  Control: Text@0.0.51
                                  Properties:
                                    AutoHeight: =true
                                    FontColor: =ColorValue(varTheme.neutralForeground1)
                                    Text: =Concatenate(Text(varSelectedShift.'Team Position'.'Shift Team'.'Shift Type'.Startdate , DateTimeFormat.ShortTime) & " - " & Text(varSelectedShift.'Team Position'.'Shift Team'.'Shift Type'.Enddate, DateTimeFormat.ShortTime))
                                    Weight: ='TextCanvas.Weight'.Regular
                                    Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                        - conReason_RequestTimeOff:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              AlignInContainer: =AlignInContainer.SetByContainer
                              DropShadow: =DropShadow.None
                              Fill: =ColorValue(varTheme.neutralBackground1)
                              FillPortions: =0
                              Height: =txtReason_RequestTimeOff.Height + Self.LayoutGap + txiReason_RequestTimeOff.Height
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutGap: =8
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Parent.Width
                            Children:
                              - txtReason_RequestTimeOff:
                                  Control: Text@0.0.51
                                  Properties:
                                    AutoHeight: =true
                                    FontColor: =ColorValue(varTheme.neutralForeground1)
                                    Text: ="Reason"
                                    Weight: ='TextCanvas.Weight'.Semibold
                                    Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                              - txiReason_RequestTimeOff:
                                  Control: TextInput@0.0.54
                                  Properties:
                                    AccessibleLabel: ="Text Input"
                                    Appearance: ='TextInputCanvas.Appearance'.Outline
                                    FontItalic: =
                                    Height: =200
                                    Mode: ='TextInputCanvas.Mode'.Multiline
                                    Placeholder: =
                                    Type: ='TextInputCanvas.Type'.Text
                                    Width: =Parent.Width
            - conButtons_RequestTimeOff:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  DropShadow: =DropShadow.None
                  Fill: =ColorValue(varTheme.neutralBackground2)
                  FillPortions: =0
                  Height: =56
                  LayoutDirection: =LayoutDirection.Horizontal
                  LayoutGap: =12
                  LayoutJustifyContent: =LayoutJustifyContent.Center
                  PaddingBottom: =12
                  PaddingTop: =12
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                  Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                Children:
                  - btnBack_RequestTimeOff:
                      Control: Button@0.0.45
                      Properties:
                        AccessibleLabel: ="Secondary"
                        Appearance: ='ButtonCanvas.Appearance'.Secondary
                        FontItalic: =
                        OnSelect: =Back()
                        Text: ="Back"
                        Width: =170
                  - btnSubmit_RequestTimeOff:
                      Control: Button@0.0.45
                      Properties:
                        AccessibleLabel: ="Primary"
                        Appearance: ='ButtonCanvas.Appearance'.Primary
                        DisplayMode: =If(IsBlank(txiReason_RequestTimeOff.Value) || Len(Trim(txiReason_RequestTimeOff.Value))<=0, DisplayMode.Disabled,DisplayMode.Edit)
                        FontItalic: =
                        OnSelect: |
                          =IfError(
                              //Insert new record to change request
                              Patch(
                                  'Change Requests',
                                  Defaults('Change Requests'),
                                  {
                                      Resource: LookUp(
                                          Users,
                                          'Primary Email' = varCurrentUser.Email
                                      ),
                                      //'New Resource': varSelectedTeamPosition.Resource,
                                      Reason: txiReason_RequestTimeOff.Value,
                                      'Shift Booking': varSelectedShift,
                                      //'Swap With': varSelectedTeamPosition,
                                      'Change Type': 'Change type'.'Time off'
                                  }
                              );
                              //Update Shift Booking Workflow Status
                              Patch(
                                  'Shift Bookings',
                                  LookUp(
                                      'Shift Bookings',
                                      shiftplanner_shiftbooking = varSelectedShift.shiftplanner_shiftbooking
                                  ),
                                  {'Workflow Status': 'Workflow Status (Shift Bookings)'.Yes}
                              );
                              Navigate('Shift Details Screen');
                              ,
                              Notify(
                                  "Error inserting record.",
                                  NotificationType.Error
                              ),
                              Notify(
                                  "Request has been submitted",
                                  NotificationType.Success
                              )
                          );
                        Text: ="Submit"
                        Width: =170
      - cmpHeaderMobile_RequestTimeOff:
          Control: CanvasComponent
          ComponentName: compHeaderMobile
          Properties:
            AllShiftsScreen: ='All Shifts Screen'
            BackScreen: ='Home Screen'
            HeaderTitle: ="Request Time Off"
            Height: =104
            HomeScreen: ='Home Screen'
            MyRequestsScreen: ='Request Screen'
            NavigationScreen: ='Navigation Screen'
            ProfileImage: =varCurrentUser.Image
            ProfileScreen: ='Profile Screen'
            TeamsEmbeddedMode: =varIsTeamsEmbedded
            Width: =App.Width
