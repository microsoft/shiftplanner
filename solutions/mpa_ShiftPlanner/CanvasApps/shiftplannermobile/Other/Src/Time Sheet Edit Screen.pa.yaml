# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  Time Sheet Edit Screen:
    Properties:
      OnVisible: =Select(btnHiddenRefreshBreaks_EditTimeSheet);
    Children:
      - conMainContent_EditTimeSheet:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            DropShadow: =DropShadow.None
            Height: =Parent.Height - compHeaderMobile_EditTimeSheet.Height
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =5
            PaddingBottom: =16
            PaddingLeft: |+
              =Switch(App.ActiveScreen.Size,
              5, (App.Width - 1580)/2,
              4, 20,
              3, 20,
              2, 20,
              1, 0
              )

            PaddingRight: |-
              =Switch(App.ActiveScreen.Size,
              5, (App.Width - 1580)/2,
              4, 20,
              3, 20,
              2, 20,
              1, 0
              )
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =Parent.Width
            Y: '=compHeaderMobile_EditTimeSheet.Height '
          Children:
            - btnHiddenSaveShiftDetails_EditTimeSheet:
                Control: Button@0.0.45
                Properties:
                  AlignInContainer: =AlignInContainer.Stretch
                  LayoutMaxHeight: =0
                  LayoutMaxWidth: =0
                  LayoutMinHeight: =16
                  LayoutMinWidth: =16
                  OnSelect: |+
                    =//////////////////////////////////////////////////////
                    //// Calculate summary and Save the timesheet header
                    //////////////////////////////////////////////////////

                    // Extract the start time
                    UpdateContext({varActualStartTime :
                        If(
                            !IsBlank(dcActualStartDateValue_EditTimeSheet.SelectedDate),
                            DateTimeValue(
                                DateValue(dcActualStartDateValue_EditTimeSheet.SelectedDate) + Time(First(dcActualStartHourValue_EditTimeSheet.SelectedItems).Value, First(dcActualStartMinuteValue_EditTimeSheet.SelectedItems).Value, 0)
                            ), 
                            Blank()
                        )
                    });

                    // Extract the end time
                    UpdateContext({varActualEndTime :
                        If(!IsBlank(dcActualStartDateValue_EditTimeSheet.SelectedDate),
                                DateTimeValue(
                                    DateValue(dcActualEndDateValue_EditTimeSheet.SelectedDate) + Time(First(dcActualEndHourValue_EditTimeSheet.SelectedItems).Value, First(dcActualEndMinuteValue_EditTimeSheet.SelectedItems).Value, 0)
                                ), 
                            Blank()
                        )
                    });

                    // Calculate Total Break Time
                    UpdateContext({varOffClockDuration : Sum(Filter('Time Sheet Entries', 'Shift Booking'.shiftplanner_shiftbooking = varTimeSheetToEdit.shiftplanner_shiftbooking), ThisRecord.'Duration Minutes')});

                    // Calculate Total Working Time
                    UpdateContext({varOnClockDuration : 
                        If(
                            Or(IsBlank(varActualEndTime),IsBlank(varActualEndTime)),
                            Blank(),
                            DateDiff(varActualStartTime, varActualEndTime, TimeUnit.Minutes) + varOffClockDuration
                        )
                    });

                    IfError(
                        Patch('Shift Bookings', varTimeSheetToEdit, {
                            'Actual End Time': varActualEndTime,
                            'Actual Start Time': varActualStartTime,
                            'Actual Worked Duration': varOnClockDuration,
                            'Break Duration': varOffClockDuration,
                            'Timesheet Notes': dcNotesDataCardValue_EditTimeSheet.Value
                        }),
                        Notify("Unable to Save. " & FirstError.Message)
                    );
                  Text: ="Hidden Shift Save"
                  Visible: =false
                  X: =40
                  Y: =40
            - btnHiddenRefreshBreaks_EditTimeSheet:
                Control: Button@0.0.45
                Properties:
                  AlignInContainer: =AlignInContainer.Stretch
                  LayoutMaxHeight: =0
                  LayoutMaxWidth: =0
                  LayoutMinHeight: =16
                  LayoutMinWidth: =16
                  OnSelect: |-
                    =// Make sure the names match

                    With(
                        {
                            breaks: SortByColumns(
                                Filter('Time Sheet Entries', 'Shift Booking'.shiftplanner_shiftbooking = varTimeSheetToEdit.shiftplanner_shiftbooking),
                                "mpa_starttime",
                                SortOrder.Ascending
                            )
                        },
                        ForAll(
                            Sequence(CountRows(breaks)),
                            With(
                                {
                                    rec: Last(FirstN(breaks, Value)),
                                    expectedName: "Break " & Text(Value, "0")
                                },
                                If(
                                    Lower(Trim(rec.Name)) <> Lower(Trim(expectedName)),
                                    Patch('Time Sheet Entries', rec, { Name: expectedName })
                                )
                            )
                        )
                    );




                    UpdateContext({
                        colTimeSheetEntries :Filter('Time Sheet Entries', 'Shift Booking'.shiftplanner_shiftbooking = varTimeSheetToEdit.shiftplanner_shiftbooking)
                    });
                    /*
                    ForAll(
                        Sequence(CountRows(colTimeSheetEntries)),
                        Patch(
                            'Time Sheet Entries',
                            Last(FirstN(Sort(colTimeSheetEntries, 'Start Time'), Value)),
                            { Name: "Break " & Value }
                        )
                    );*/
                  Text: ="Hidden Refresh"
                  Visible: =false
            - conShiftDetails_EditTimeSheet:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  DropShadow: =DropShadow.None
                  Fill: =ColorValue(varTheme.neutralBackground3)
                  FillPortions: =0
                  Height: =65
                  LayoutAlignItems: =LayoutAlignItems.Center
                  LayoutDirection: =LayoutDirection.Vertical
                  LayoutMaxHeight: =0
                  LayoutMaxWidth: =0
                  LayoutMinHeight: =16
                  LayoutMinWidth: =16
                  PaddingLeft: =10
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                  X: =40
                  Y: =40
                Children:
                  - txtZoneAndRole_EditTimeSheet:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        AlignInContainer: =AlignInContainer.Stretch
                        Height: =20
                        LayoutMaxHeight: =0
                        LayoutMaxWidth: =0
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        Text: =varTimeSheetToEdit.Zone.Name & " (" & varTimeSheetToEdit.'Team Position'.Role.Name & ")"
                        Weight: =varThemeFont.H3.weightBold
                  - txtDate_EditTimeSheet:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        AlignInContainer: =AlignInContainer.Stretch
                        AutoHeight: =true
                        FillPortions: =1
                        FontColor: =ColorValue(varTheme.neutralForeground1)
                        Height: =20
                        LayoutMinHeight: =20
                        LayoutMinWidth: =80
                        Text: =Text(varTimeSheetToEdit.Date, "dddd, d mmmm yyyy")
                        VerticalAlign: =VerticalAlign.Middle
                        Weight: =varThemeFont.H3.weight
                        Width: =60
                        X: =40
                        Y: =40
                  - txtShiftType_EditTimeSheet:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        AlignInContainer: =AlignInContainer.Stretch
                        AutoHeight: =true
                        FillPortions: =1
                        FontColor: =ColorValue(varTheme.neutralForeground1)
                        Height: =20
                        LayoutMinHeight: =20
                        LayoutMinWidth: =80
                        Text: =varTimeSheetToEdit.'Team Position'.'Shift Team'.'Shift Type'.Name & " " & Concatenate(Text(varTimeSheetToEdit.'Team Position'.'Shift Team'.'Shift Type'.'Start Date Time' , DateTimeFormat.ShortTime) & " - " & Text(varTimeSheetToEdit.'Team Position'.'Shift Team'.'Shift Type'.'End Date', DateTimeFormat.ShortTime)) & ""
                        VerticalAlign: =VerticalAlign.Middle
                        Weight: =varThemeFont.H3.weight
                        Width: =60
                        X: =40
                        Y: =40
            - frmShiftBooking_EditTimeSheet:
                Control: Form@2.4.4
                Layout: Vertical
                Properties:
                  DataSource: ='Shift Bookings'
                  FillPortions: =0
                  FocusedBorderThickness: =0
                  Height: =235
                  Item: =varTimeSheetToEdit
                  LayoutMinWidth: =300
                  NumberOfColumns: =1
                  Width: =759
                  X: =40
                  Y: =40
                Children:
                  - dcActualStartTime_EditTimeSheet:
                      Control: TypedDataCard@1.0.7
                      Variant: DateTimeEdit
                      Properties:
                        DataField: ="mpa_actualstarttime"
                        Default: =ThisItem.'Actual Start Time'
                        DisplayName: =DataSourceInfo([@'Shift Bookings'],DataSourceInfo.DisplayName,'Actual Start Time')
                        Height: =60
                        Required: =false
                        Update: =If(Not IsBlank(dcActualStartDateValue_EditTimeSheet.SelectedDate), DateTime(Year(dcActualStartDateValue_EditTimeSheet.SelectedDate), Month(dcActualStartDateValue_EditTimeSheet.SelectedDate), Day(dcActualStartDateValue_EditTimeSheet.SelectedDate), Value(dcActualStartHourValue_EditTimeSheet.Selected.Value), Value(dcActualStartMinuteValue_EditTimeSheet.Selected.Value), Second(dcActualStartDateValue_EditTimeSheet.SelectedDate)))
                        Width: =Parent.Width
                        X: =0
                        Y: =0
                      Children:
                        - dcActualStartDataCardKey_EditTimeSheet:
                            Control: Text@0.0.51
                            MetadataKey: FieldName
                            Properties:
                              Height: =22
                              Text: ="Start Time"
                              Weight: =varThemeFont.H3.weight
                              Width: =Parent.Width - 48
                              Wrap: =false
                              X: =15
                        - dcActualStartDateValue_EditTimeSheet:
                            Control: DatePicker@0.0.46
                            MetadataKey: DateFieldValue
                            Properties:
                              AccessibleLabel: =Parent.DisplayName
                              DisplayMode: =Parent.DisplayMode
                              OnChange: =Select(btnHiddenSaveShiftDetails_EditTimeSheet)
                              SelectedDate: =Parent.Default
                              ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                              Width: =(Parent.Width - 38) / 2
                              X: =15
                              Y: =dcActualStartDataCardKey_EditTimeSheet.Y + dcActualStartDataCardKey_EditTimeSheet.Height + 4
                        - dcActualStartHourValue_EditTimeSheet:
                            Control: DropDown@0.0.45
                            MetadataKey: HourFieldValue
                            Properties:
                              AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                              DefaultSelectedItems: =[Text(Hour(Parent.Default),"00")]
                              DisplayMode: =Parent.DisplayMode
                              Height: =28
                              Items: =["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"]
                              OnChange: =Select(btnHiddenSaveShiftDetails_EditTimeSheet)
                              Required: =Parent.Required
                              ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                              Width: =dcActualStartDateValue_EditTimeSheet.Width / 2 - 10
                              X: =dcActualStartDateValue_EditTimeSheet.X + dcActualStartDateValue_EditTimeSheet.Width + 10
                              Y: =dcActualStartDateValue_EditTimeSheet.Y + 1
                        - dcActualStartSeparator_EditTimeSheet:
                            Control: Text@0.0.51
                            MetadataKey: HourMinuteSeparator
                            Properties:
                              Align: ='TextCanvas.Align'.Center
                              Height: =dcActualStartHourValue_EditTimeSheet.Height
                              Text: =":"
                              Width: =10
                              X: =dcActualStartHourValue_EditTimeSheet.X + dcActualStartHourValue_EditTimeSheet.Width
                              Y: =dcActualStartHourValue_EditTimeSheet.Y
                        - dcActualStartMinuteValue_EditTimeSheet:
                            Control: DropDown@0.0.45
                            MetadataKey: MinuteFieldValue
                            Properties:
                              AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                              DefaultSelectedItems: =[Text(Minute(Parent.Default),"00")]
                              DisplayMode: =Parent.DisplayMode
                              Height: =28
                              Items: =["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"]
                              OnChange: =Select(btnHiddenSaveShiftDetails_EditTimeSheet)
                              ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                              Width: =dcActualStartHourValue_EditTimeSheet.Width
                              X: =dcActualStartHourValue_EditTimeSheet.X + dcActualStartHourValue_EditTimeSheet.Width + dcActualStartSeparator_EditTimeSheet.Width
                              Y: =dcActualStartHourValue_EditTimeSheet.Y + 1
                        - dcActualStartErrorMessage_EditTimeSheet:
                            Control: Text@0.0.51
                            MetadataKey: ErrorMessage
                            Properties:
                              Height: =30
                              Text: =Parent.Error
                              Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                              Width: =Parent.Width - 48
                              X: =24
                              Y: =dcActualStartDateValue_EditTimeSheet.Y + dcActualStartDateValue_EditTimeSheet.Height
                        - dcActualStartStarVisible_EditTimeSheet:
                            Control: Text@0.0.51
                            MetadataKey: FieldRequired
                            Properties:
                              Align: ='TextCanvas.Align'.Center
                              Height: =20
                              Text: ="*"
                              Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                              Width: =30
                              Y: =dcActualStartDataCardKey_EditTimeSheet.Y
                  - dcActualEndTime_EditTimeSheet:
                      Control: TypedDataCard@1.0.7
                      Variant: DateTimeEdit
                      Properties:
                        DataField: ="mpa_actualendtime"
                        Default: =ThisItem.'Actual End Time'
                        DisplayName: =DataSourceInfo([@'Shift Bookings'],DataSourceInfo.DisplayName,'Actual End Time')
                        Required: =false
                        Update: =If(Not IsBlank(dcActualEndDateValue_EditTimeSheet.SelectedDate), DateTime(Year(dcActualEndDateValue_EditTimeSheet.SelectedDate), Month(dcActualEndDateValue_EditTimeSheet.SelectedDate), Day(dcActualEndDateValue_EditTimeSheet.SelectedDate), Value(dcActualEndHourValue_EditTimeSheet.Selected.Value), Value(dcActualEndMinuteValue_EditTimeSheet.Selected.Value), Second(dcActualEndDateValue_EditTimeSheet.SelectedDate)))
                        Width: =Parent.Width
                        X: =0
                        Y: =1
                      Children:
                        - dcActualEndDataCardKey_EditTimeSheet:
                            Control: Text@0.0.51
                            MetadataKey: FieldName
                            Properties:
                              Height: =22
                              Text: ="End Time"
                              Weight: =varThemeFont.H3.weight
                              Width: =Parent.Width - 48
                              Wrap: =false
                              X: =15
                              Y: =10
                        - dcActualEndDateValue_EditTimeSheet:
                            Control: DatePicker@0.0.46
                            MetadataKey: DateFieldValue
                            Properties:
                              AccessibleLabel: =Parent.DisplayName
                              DisplayMode: =Parent.DisplayMode
                              OnChange: =Select(btnHiddenSaveShiftDetails_EditTimeSheet)
                              SelectedDate: =Parent.Default
                              ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                              Width: =(Parent.Width - 38) / 2
                              X: =15
                              Y: =dcActualEndDataCardKey_EditTimeSheet.Y + dcActualEndDataCardKey_EditTimeSheet.Height + 4
                        - dcActualEndHourValue_EditTimeSheet:
                            Control: DropDown@0.0.45
                            MetadataKey: HourFieldValue
                            Properties:
                              AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                              DefaultSelectedItems: =[Text(Hour(Parent.Default),"00")]
                              DisplayMode: =Parent.DisplayMode
                              Height: =28
                              Items: =["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"]
                              OnChange: =Select(btnHiddenSaveShiftDetails_EditTimeSheet)
                              Required: =Parent.Required
                              ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                              Width: =dcActualEndDateValue_EditTimeSheet.Width / 2 - 10
                              X: =dcActualEndDateValue_EditTimeSheet.X + dcActualEndDateValue_EditTimeSheet.Width + 10
                              Y: =dcActualEndDateValue_EditTimeSheet.Y + 1
                        - dcActualEndSeparator_EditTimeSheet:
                            Control: Text@0.0.51
                            MetadataKey: HourMinuteSeparator
                            Properties:
                              Align: ='TextCanvas.Align'.Center
                              Height: =dcActualEndHourValue_EditTimeSheet.Height
                              Text: =":"
                              Width: =10
                              X: =dcActualEndHourValue_EditTimeSheet.X + dcActualEndHourValue_EditTimeSheet.Width
                              Y: =dcActualEndHourValue_EditTimeSheet.Y
                        - dcActualEndMinuteValue_EditTimeSheet:
                            Control: DropDown@0.0.45
                            MetadataKey: MinuteFieldValue
                            Properties:
                              AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                              DefaultSelectedItems: =[Text(Minute(Parent.Default),"00")]
                              DisplayMode: =Parent.DisplayMode
                              Height: =28
                              Items: =["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"]
                              OnChange: =Select(btnHiddenSaveShiftDetails_EditTimeSheet)
                              ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                              Width: =dcActualEndHourValue_EditTimeSheet.Width
                              X: =dcActualEndHourValue_EditTimeSheet.X + dcActualEndHourValue_EditTimeSheet.Width + dcActualEndSeparator_EditTimeSheet.Width
                              Y: =dcActualEndHourValue_EditTimeSheet.Y + 1
                        - dcActualEndErrorMessage_EditTimeSheet:
                            Control: Text@0.0.51
                            MetadataKey: ErrorMessage
                            Properties:
                              Height: =30
                              Text: =Parent.Error
                              Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                              Width: =Parent.Width - 48
                              X: =24
                              Y: =dcActualEndDateValue_EditTimeSheet.Y + dcActualEndDateValue_EditTimeSheet.Height
                        - dcActualEndStarVisible_EditTimeSheet:
                            Control: Text@0.0.51
                            MetadataKey: FieldRequired
                            Properties:
                              Align: ='TextCanvas.Align'.Center
                              Height: =20
                              Text: ="*"
                              Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                              Width: =30
                              Y: =dcActualEndDataCardKey_EditTimeSheet.Y
                  - dcNotes_EditTimeSheet:
                      Control: TypedDataCard@1.0.7
                      Variant: TextualMultilineEdit
                      Properties:
                        DataField: ="mpa_timesheetnotes"
                        Default: =ThisItem.'Timesheet Notes'
                        DisplayName: =DataSourceInfo([@'Shift Bookings'],DataSourceInfo.DisplayName,'Timesheet Notes')
                        Height: =90
                        Required: =false
                        Update: =dcNotesDataCardValue_EditTimeSheet.Value
                        Width: =Parent.Width
                        X: =0
                        Y: =2
                      Children:
                        - dcNotesDataCardKey_EditTimeSheet:
                            Control: Text@0.0.51
                            MetadataKey: FieldName
                            Properties:
                              Height: =22
                              Text: ="Notes"
                              Weight: =varThemeFont.H3.weight
                              Width: =Parent.Width - 48
                              Wrap: =false
                              X: =15
                              Y: =10
                        - dcNotesDataCardValue_EditTimeSheet:
                            Control: TextInput@0.0.54
                            MetadataKey: FieldValue
                            Properties:
                              AccessibleLabel: =Parent.DisplayName
                              DisplayMode: =Parent.DisplayMode
                              Height: =60
                              Mode: ='TextInputCanvas.Mode'.Multiline
                              OnChange: =Select(btnHiddenSaveShiftDetails_EditTimeSheet)
                              Required: =Parent.Required
                              ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                              Value: =Parent.Default
                              Width: =Parent.Width - 38
                              X: =15
                              Y: =dcNotesDataCardKey_EditTimeSheet.Y + dcNotesDataCardKey_EditTimeSheet.Height + 4
                        - dcNotesErrorMessage_EditTimeSheet:
                            Control: Text@0.0.51
                            MetadataKey: ErrorMessage
                            Properties:
                              Height: =30
                              Text: =Parent.Error
                              Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                              Width: =Parent.Width - 48
                              X: =24
                              Y: =dcNotesDataCardValue_EditTimeSheet.Y + dcNotesDataCardValue_EditTimeSheet.Height
                        - dcNotesStarVisible_EditTimeSheet:
                            Control: Text@0.0.51
                            MetadataKey: FieldRequired
                            Properties:
                              Align: ='TextCanvas.Align'.Center
                              Height: =30
                              Text: ="*"
                              Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                              Width: =30
                              Y: =dcNotesDataCardKey_EditTimeSheet.Y
            - galBreaks_EditTimeSheet:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  FocusedBorderThickness: =0
                  Items: =SortByColumns(colTimeSheetEntries,"mpa_starttime", SortOrder.Ascending, "createdon", SortOrder.Ascending)
                  LayoutMaxHeight: =0
                  LayoutMaxWidth: =0
                  LayoutMinHeight: =16
                  LayoutMinWidth: =16
                  TemplateSize: =180
                Children:
                  - conBreakForm_EditTimeSheet:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        DropShadow: =DropShadow.None
                        Height: =Parent.TemplateHeight
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutDirection: =LayoutDirection.Vertical
                        PaddingLeft: =15
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =Parent.Width-20
                      Children:
                        - lblBreakName_EditTimeSheet:
                            Control: Text@0.0.51
                            Properties:
                              Align: ='TextCanvas.Align'.Start
                              AlignInContainer: =AlignInContainer.Stretch
                              Height: =24
                              Text: =ThisItem.Name
                              Weight: ='TextCanvas.Weight'.Semibold
                              Width: =Parent.Width
                        - lblStartTime_EditTimeSheet:
                            Control: Text@0.0.51
                            Properties:
                              AlignInContainer: =AlignInContainer.Stretch
                              Height: =22
                              Text: ="Start Time"
                              Weight: =varThemeFont.H3.weight
                              Width: =Parent.Width
                        - conStartTime_EditTimeSheet:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              DropShadow: =DropShadow.None
                              FillPortions: =0
                              Height: =34
                              LayoutAlignItems: =LayoutAlignItems.Center
                              LayoutDirection: =LayoutDirection.Horizontal
                              LayoutGap: =10
                              LayoutMaxHeight: =0
                              LayoutMaxWidth: =0
                              LayoutMinHeight: =16
                              LayoutMinWidth: =16
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                            Children:
                              - cmbBreakStartDate_EditTimeSheet:
                                  Control: DatePicker@0.0.46
                                  Properties:
                                    FillPortions: =2
                                    Height: =30
                                    LayoutMaxHeight: =0
                                    LayoutMaxWidth: =0
                                    LayoutMinHeight: =16
                                    LayoutMinWidth: =30
                                    OnChange: =Select(btnHiddenSaveBreak_EditTimeSheet)
                                    SelectedDate: =ThisItem.'Start Time'
                              - cmbBreakStartHour_EditTimeSheet:
                                  Control: DropDown@0.0.45
                                  Properties:
                                    AccessibleLabel: ="Start Break Hour"
                                    DefaultSelectedItems: =[Text(Hour(ThisItem.'Start Time'),"00")]
                                    DisplayMode: =Parent.DisplayMode
                                    FillPortions: =1
                                    Height: =28
                                    Items: =["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"]
                                    LayoutMinWidth: =30
                                    OnChange: =Select(btnHiddenSaveBreak_EditTimeSheet)
                                    Required: =true
                                    ValidationState: =
                                    Width: =dcActualStartDateValue_EditTimeSheet.Width / 2 - 10
                                    X: =dcActualStartDateValue_EditTimeSheet.X + dcActualStartDateValue_EditTimeSheet.Width + 10
                                    Y: =dcActualStartDateValue_EditTimeSheet.Y + 1
                              - cmbBreakStartMin_EditTimeSheet:
                                  Control: DropDown@0.0.45
                                  Properties:
                                    AccessibleLabel: ="Start Break Hour"
                                    DefaultSelectedItems: =[Text(Minute(ThisItem.'Start Time'),"00")]
                                    DisplayMode: =Parent.DisplayMode
                                    FillPortions: =1
                                    Height: =28
                                    Items: =["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"]
                                    LayoutMinWidth: =30
                                    OnChange: =Select(btnHiddenSaveBreak_EditTimeSheet)
                                    ValidationState: =
                                    Width: =cmbBreakStartHour_EditTimeSheet.Width
                                    X: =cmbBreakStartHour_EditTimeSheet.X + cmbBreakStartHour_EditTimeSheet.Width + dcActualStartSeparator_EditTimeSheet.Width
                                    Y: =cmbBreakStartHour_EditTimeSheet.Y + 1
                        - lblEndTime_EditTimeSheet:
                            Control: Text@0.0.51
                            Properties:
                              AlignInContainer: =AlignInContainer.Stretch
                              Height: =22
                              Text: ="End Time"
                              Weight: =varThemeFont.H3.weight
                              Width: =Parent.Width
                        - conEndTime_EditTimeSheet:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              DropShadow: =DropShadow.None
                              FillPortions: =0
                              Height: =34
                              LayoutAlignItems: =LayoutAlignItems.Center
                              LayoutDirection: =LayoutDirection.Horizontal
                              LayoutGap: =10
                              LayoutMaxHeight: =0
                              LayoutMaxWidth: =0
                              LayoutMinHeight: =16
                              LayoutMinWidth: =16
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                            Children:
                              - cmbBreakEndDate_EditTimeSheet:
                                  Control: DatePicker@0.0.46
                                  Properties:
                                    FillPortions: =2
                                    Height: =30
                                    LayoutMaxHeight: =0
                                    LayoutMaxWidth: =0
                                    LayoutMinHeight: =16
                                    LayoutMinWidth: =30
                                    OnChange: =Select(btnHiddenSaveBreak_EditTimeSheet)
                                    SelectedDate: =ThisItem.'End Time'
                              - cmbBreakEndHour_EditTimeSheet:
                                  Control: DropDown@0.0.45
                                  Properties:
                                    AccessibleLabel: ="Start Break Hour"
                                    DefaultSelectedItems: =[Text(Hour(ThisItem.'End Time'),"00")]
                                    DisplayMode: =Parent.DisplayMode
                                    FillPortions: =1
                                    Height: =28
                                    Items: =["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"]
                                    LayoutMinWidth: =30
                                    OnChange: =Select(btnHiddenSaveBreak_EditTimeSheet)
                                    Required: =true
                                    ValidationState: =
                                    Width: =dcActualStartDateValue_EditTimeSheet.Width / 2 - 10
                                    X: =dcActualStartDateValue_EditTimeSheet.X + dcActualStartDateValue_EditTimeSheet.Width + 10
                                    Y: =dcActualStartDateValue_EditTimeSheet.Y + 1
                              - cmbBreakEndMin_EditTimeSheet:
                                  Control: DropDown@0.0.45
                                  Properties:
                                    AccessibleLabel: ="Start Break Hour"
                                    DefaultSelectedItems: =[Text(Minute(ThisItem.'End Time'),"00")]
                                    DisplayMode: =Parent.DisplayMode
                                    FillPortions: =1
                                    Height: =28
                                    Items: =["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"]
                                    LayoutMinWidth: =30
                                    OnChange: =Select(btnHiddenSaveBreak_EditTimeSheet)
                                    ValidationState: =
                                    Width: =cmbBreakEndHour_EditTimeSheet.Width
                                    X: =cmbBreakEndHour_EditTimeSheet.X + cmbBreakEndHour_EditTimeSheet.Width + dcActualStartSeparator_EditTimeSheet.Width
                                    Y: =cmbBreakEndHour_EditTimeSheet.Y + 1
                        - rectSpacer_EditTimeSheet:
                            Control: Rectangle@2.3.0
                            Properties:
                              AlignInContainer: =AlignInContainer.Stretch
                              Fill: =RGBA(0,0,0,0)
                              FocusedBorderThickness: =0
                              Height: =5
                              LayoutMaxHeight: =0
                              LayoutMaxWidth: =0
                              LayoutMinHeight: =16
                              LayoutMinWidth: =16
                              X: =40
                              Y: =40
                        - btnDeleteBreak_EditTimeSheet:
                            Control: Button@0.0.45
                            Properties:
                              AlignInContainer: =AlignInContainer.Start
                              Appearance: ='ButtonCanvas.Appearance'.Secondary
                              FontSize: =14
                              Height: =26
                              Icon: ="DismissCircle"
                              LayoutMaxHeight: =0
                              LayoutMaxWidth: =0
                              LayoutMinHeight: =16
                              LayoutMinWidth: =16
                              OnSelect: "=IfError(\r\n    Remove('Time Sheet Entries', ThisItem),\r\n    \r\n    Notify(\"Delete failed: \" & FirstError.Message, NotificationType.Error),\r\n    \r\n    Select(btnHiddenRefreshBreaks_EditTimeSheet);\r\n);\r\n"
                              Text: ="Delete"
                              Width: =80
                              X: =40
                              Y: =40
                  - btnHiddenSaveBreak_EditTimeSheet:
                      Control: Button@0.0.45
                      Properties:
                        Height: =28
                        OnSelect: |-
                          =IfError(
                              Patch('Time Sheet Entries', ThisItem, {
                                  'Start Time': 
                                          If(!IsBlank(cmbBreakStartDate_EditTimeSheet.SelectedDate),
                                              DateTimeValue(
                                                  DateValue(cmbBreakStartDate_EditTimeSheet.SelectedDate) + Time(First(cmbBreakStartHour_EditTimeSheet.SelectedItems).Value, First(cmbBreakStartMin_EditTimeSheet.SelectedItems).Value, 0)
                                              ), 
                                          Blank()
                                      ),
                                  'End Time': 
                                      If(!IsBlank(cmbBreakEndDate_EditTimeSheet.SelectedDate),
                                          DateTimeValue(
                                              DateValue(cmbBreakEndDate_EditTimeSheet.SelectedDate) + Time(First(cmbBreakEndHour_EditTimeSheet.SelectedItems).Value, First(cmbBreakEndMin_EditTimeSheet.SelectedItems).Value, 0)
                                          ), 
                                          Blank()
                                      )
                              }),
                              Notify("Unable to Save. " & FirstError.Message)
                          );

                          Select(btnHiddenSaveShiftDetails_EditTimeSheet);
                        Text: ="Hidden Save"
                        Visible: =false
            - conAddBreak_EditTimeSheet:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  DropShadow: =DropShadow.None
                  FillPortions: =0
                  Height: =26
                  LayoutAlignItems: =LayoutAlignItems.Center
                  LayoutDirection: =LayoutDirection.Horizontal
                  LayoutJustifyContent: =LayoutJustifyContent.End
                  LayoutMaxHeight: =0
                  LayoutMaxWidth: =0
                  LayoutMinHeight: =16
                  LayoutMinWidth: =16
                  PaddingRight: =20
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                Children:
                  - btnAddBreak_EditTimeSheet:
                      Control: Button@0.0.45
                      Properties:
                        Align: =Align.Center
                        AlignInContainer: =AlignInContainer.Stretch
                        Appearance: ='ButtonCanvas.Appearance'.Secondary
                        FontSize: =14
                        Height: =26
                        Icon: ="Add"
                        LayoutMaxHeight: =0
                        LayoutMaxWidth: =0
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        OnSelect: "=IfError(\r\n    Patch(\r\n        'Time Sheet Entries', \r\n        Defaults('Time Sheet Entries'), {\r\n            Name: \"Break \" & CountRows(colTimeSheetEntries) + 1, \r\n            'Start Time': varTimeSheetToEdit.'Actual Start Time',\r\n            'End Time': varTimeSheetToEdit.'Actual Start Time',\r\n            'Shift Booking': varTimeSheetToEdit\r\n        }\r\n    ),\r\n\r\n    Notify(\"Error saving \" & FirstError.Message)\r\n    \r\n\r\n);\r\nSelect(btnHiddenRefreshBreaks_EditTimeSheet);"
                        Text: ="Add Break"
                        Width: =120
                        X: =40
                        Y: =40
      - compHeaderMobile_EditTimeSheet:
          Control: CanvasComponent
          ComponentName: compHeaderMobile
          Properties:
            AllShiftsScreen: ='All Shifts Screen'
            BackScreen: ='Time Sheet View Screen'
            HeaderTitle: ="Edit Time Sheet"
            Height: =104
            HomeScreen: ='Home Screen'
            MyRequestsScreen: ='Request Screen'
            NavigationScreen: ='Navigation Screen'
            ProfileImage: =varCurrentUser.Image
            ProfileScreen: ='Profile Screen'
            SelectedBooking: |-
              ={SampleStringField: "SampleText", SampleNumberField: 10, SampleBooleanField: true}
            TeamsEmbeddedMode: =varIsTeamsEmbedded
            TimeTrackScreen: ='Time Sheet View Screen'
            Width: =App.Width
